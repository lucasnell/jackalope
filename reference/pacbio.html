<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create and write PacBio reads to FASTQ file(s). — pacbio • jackalope</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create and write PacBio reads to FASTQ file(s). — pacbio"><meta property="og:description" content="From either a reference genome or set of variant haplotypes, create PacBio reads
and write them to FASTQ output file(s).
I encourage you to cite the reference below in addition to jackalope if you use
this function."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jackalope</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jackalope-intro.html">Intro to jackalope</a>
    </li>
    <li>
      <a href="../articles/sub-models.html">Models of nucleotide substitution</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/lucasnell/jackalope/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create and write PacBio reads to FASTQ file(s).</h1>
    <small class="dont-index">Source: <a href="https://github.com/lucasnell/jackalope/blob/v1.1.6/R/hts_pacbio.R" class="external-link"><code>R/hts_pacbio.R</code></a></small>
    <div class="hidden name"><code>pacbio.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>From either a reference genome or set of variant haplotypes, create PacBio reads
and write them to FASTQ output file(s).
I encourage you to cite the reference below in addition to <code>jackalope</code> if you use
this function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pacbio</span><span class="op">(</span><span class="va">obj</span>,</span>
<span>       <span class="va">out_prefix</span>,</span>
<span>       <span class="va">n_reads</span>,</span>
<span>       chi2_params_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01214</span>, <span class="op">-</span><span class="fl">5.12</span>, <span class="fl">675</span>, <span class="fl">48303.0732881</span>,</span>
<span>                         <span class="fl">1.4691051212330266</span><span class="op">)</span>,</span>
<span>       chi2_params_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.00189237136</span>, <span class="fl">2.53944970</span>, <span class="fl">5500</span><span class="op">)</span>,</span>
<span>       max_passes <span class="op">=</span> <span class="fl">40</span>,</span>
<span>       sqrt_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2247</span><span class="op">)</span>,</span>
<span>       norm_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>       prob_thresh <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>       ins_prob <span class="op">=</span> <span class="fl">0.11</span>,</span>
<span>       del_prob <span class="op">=</span> <span class="fl">0.04</span>,</span>
<span>       sub_prob <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>       min_read_length <span class="op">=</span> <span class="fl">50</span>,</span>
<span>       lognorm_read_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.200110276521</span>, <span class="op">-</span><span class="fl">10075.4363813</span>,</span>
<span>                               <span class="fl">17922.611306</span><span class="op">)</span>,</span>
<span>       custom_read_lengths <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       prob_dup <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>       haplotype_probs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       sep_files <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>       compress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>       comp_method <span class="op">=</span> <span class="st">"bgzip"</span>,</span>
<span>       n_threads <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>       read_pool_size <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>       show_progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>       overwrite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>Sequencing object of class <code>ref_genome</code> or <code>haplotypes</code>.</p></dd>


<dt id="arg-out-prefix">out_prefix<a class="anchor" aria-label="anchor" href="#arg-out-prefix"></a></dt>
<dd><p>Prefix for the output file(s), including entire path except
for the file extension.</p></dd>


<dt id="arg-n-reads">n_reads<a class="anchor" aria-label="anchor" href="#arg-n-reads"></a></dt>
<dd><p>Number of reads you want to create.</p></dd>


<dt id="arg-chi-params-s">chi2_params_s<a class="anchor" aria-label="anchor" href="#arg-chi-params-s"></a></dt>
<dd><p>Vector containing the 5 parameters for the curve determining
the scale parameter for the chi^2 distribution.
Defaults to <code>c(0.01214, -5.12, 675, 48303.0732881, 1.4691051212330266)</code>.</p></dd>


<dt id="arg-chi-params-n">chi2_params_n<a class="anchor" aria-label="anchor" href="#arg-chi-params-n"></a></dt>
<dd><p>Vector containing the 3 parameters for the function
determining the n parameter for the chi^2 distribution.
Defaults to <code>c(0.00189237136, 2.53944970, 5500)</code>.</p></dd>


<dt id="arg-max-passes">max_passes<a class="anchor" aria-label="anchor" href="#arg-max-passes"></a></dt>
<dd><p>Maximal number of passes for one molecule.
Defaults to <code>40</code>.</p></dd>


<dt id="arg-sqrt-params">sqrt_params<a class="anchor" aria-label="anchor" href="#arg-sqrt-params"></a></dt>
<dd><p>Vector containing the 2 parameters for the square root
function for the quality increase.
Defaults to <code>c(0.5, 0.2247)</code>.</p></dd>


<dt id="arg-norm-params">norm_params<a class="anchor" aria-label="anchor" href="#arg-norm-params"></a></dt>
<dd><p>Vector containing the 2 parameters for normal distributed
noise added to quality increase square root function
Defaults to <code>c(0, 0.2)</code>.</p></dd>


<dt id="arg-prob-thresh">prob_thresh<a class="anchor" aria-label="anchor" href="#arg-prob-thresh"></a></dt>
<dd><p>Upper bound for the modified total error probability.
Defaults to <code>0.2</code>.</p></dd>


<dt id="arg-ins-prob">ins_prob<a class="anchor" aria-label="anchor" href="#arg-ins-prob"></a></dt>
<dd><p>Probability for insertions for reads with one pass.
Defaults to <code>0.11</code>.</p></dd>


<dt id="arg-del-prob">del_prob<a class="anchor" aria-label="anchor" href="#arg-del-prob"></a></dt>
<dd><p>Probability for deletions for reads with one pass.
Defaults to <code>0.04</code>.</p></dd>


<dt id="arg-sub-prob">sub_prob<a class="anchor" aria-label="anchor" href="#arg-sub-prob"></a></dt>
<dd><p>Probability for substitutions for reads with one pass.
Defaults to <code>0.01</code>.</p></dd>


<dt id="arg-min-read-length">min_read_length<a class="anchor" aria-label="anchor" href="#arg-min-read-length"></a></dt>
<dd><p>Minium read length for lognormal distribution.
Defaults to <code>50</code>.</p></dd>


<dt id="arg-lognorm-read-length">lognorm_read_length<a class="anchor" aria-label="anchor" href="#arg-lognorm-read-length"></a></dt>
<dd><p>Vector containing the 3 parameters for lognormal
read length distribution.
Defaults to <code>c(0.200110276521, -10075.4363813, 17922.611306)</code>.</p></dd>


<dt id="arg-custom-read-lengths">custom_read_lengths<a class="anchor" aria-label="anchor" href="#arg-custom-read-lengths"></a></dt>
<dd><p>Sample read lengths from a vector or column in a
matrix; if a matrix, the second column specifies the sampling weights.
If <code>NULL</code>, it samples read lengths from the lognormal distribution
using parameters in <code>lognorm_read_length</code>.
Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-prob-dup">prob_dup<a class="anchor" aria-label="anchor" href="#arg-prob-dup"></a></dt>
<dd><p>A single number indicating the probability of duplicates.
Defaults to <code>0.0</code>.</p></dd>


<dt id="arg-haplotype-probs">haplotype_probs<a class="anchor" aria-label="anchor" href="#arg-haplotype-probs"></a></dt>
<dd><p>Relative probability of sampling each haplotype.
This is ignored if sequencing a reference genome.
<code>NULL</code> results in all having the same probability.
Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-sep-files">sep_files<a class="anchor" aria-label="anchor" href="#arg-sep-files"></a></dt>
<dd><p>Logical indicating whether to make separate files for each haplotype.
This argument is coerced to <code>FALSE</code> if the <code>obj</code> argument is not
a <code>haplotypes</code> object.
Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-compress">compress<a class="anchor" aria-label="anchor" href="#arg-compress"></a></dt>
<dd><p>Logical specifying whether or not to compress output file, or
an integer specifying the level of compression, from 1 to 9.
If <code>TRUE</code>, a compression level of <code>6</code> is used.
Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-comp-method">comp_method<a class="anchor" aria-label="anchor" href="#arg-comp-method"></a></dt>
<dd><p>Character specifying which type of compression to use if any
is desired. Options include <code>"gzip"</code> and <code>"bgzip"</code>.
This is ignored if <code>compress</code> is <code>FALSE</code>, and it throws an error if
it's set to <code>"gzip"</code> when <code>n_threads &gt; 1</code> (since I don't have a method to
do gzip compression in parallel).
Defaults to <code>"bgzip"</code>.</p></dd>


<dt id="arg-n-threads">n_threads<a class="anchor" aria-label="anchor" href="#arg-n-threads"></a></dt>
<dd><p>The number of threads to use in processing.
If <code>compress</code> is <code>TRUE</code> or <code>&gt; 0</code> (indicating compressed output),
setting <code>n_threads</code> to <code>2</code> or more makes this function first create an
uncompressed file/files using <code>n_threads</code> threads, then compress that/those
file/files also using <code>n_threads</code> threads.
There is no speed increase if you try to use multiple threads to create
compressed output on the fly, so that option is not included.
If you want to be conservative with disk space (by not having an uncompressed
file present even temporarily), set <code>n_threads</code> to <code>1</code>.
Threads are NOT spread across chromosomes or haplotypes, so you don't need to
think about these when choosing this argument's value.
However, all threads write to the same file/files, so there are diminishing
returns for providing many threads.
This argument is ignored if the package was not compiled with OpenMP.
Defaults to <code>1</code>.</p></dd>


<dt id="arg-read-pool-size">read_pool_size<a class="anchor" aria-label="anchor" href="#arg-read-pool-size"></a></dt>
<dd><p>The number of reads to store before writing to disk.
Increasing this number should improve speed but take up more memory.
Defaults to <code>100</code>.</p></dd>


<dt id="arg-show-progress">show_progress<a class="anchor" aria-label="anchor" href="#arg-show-progress"></a></dt>
<dd><p>Logical for whether to show a progress bar.
Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical for whether to overwrite existing FASTQ file(s) of the
same name, if they exist.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Nothing is returned.</p>
    </div>
    <div id="id-lines">
    <h2>ID lines</h2>


<p>The ID lines for FASTQ files are formatted as such:</p>
<p><code>@&lt;genome name&gt;-&lt;chromosome name&gt;-&lt;starting position&gt;-&lt;strand&gt;</code></p>
<p>where <code>genome name</code> is always <code>REF</code> for reference genomes (as opposed to haplotypes).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Stöcker, B. K., J. Köster, and S. Rahmann. 2016. SimLoRD: simulation of long
read data. <em>Bioinformatics</em> <strong>32</strong>:2704–2706.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_genome.html">create_genome</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100e3</span>, <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pacbio</span><span class="op">(</span><span class="va">rg</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>, <span class="st">"/pacbio_reads"</span><span class="op">)</span>, n_reads <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lucas A. Nell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

